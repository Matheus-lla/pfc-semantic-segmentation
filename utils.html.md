# Imports


<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->

# Dataset

------------------------------------------------------------------------

<a
href="https://github.com/Matheus-lla/pfc-semantic-segmentation/blob/main/pfc_packages/utils.py#L45"
target="_blank" style="float:right; font-size:smaller">source</a>

### SemanticKittiDataset

>  SemanticKittiDataset (data_path:str, split:str='train',
>                            load_cluster:bool=False, return_np_array:bool=True,
>                            sequence_list:list[int]|None=None)

\*An abstract class representing a :class:`Dataset`.

All datasets that represent a map from keys to data samples should
subclass it. All subclasses should overwrite :meth:`__getitem__`,
supporting fetching a data sample for a given key. Subclasses could also
optionally overwrite :meth:`__len__`, which is expected to return the
size of the dataset by many :class:`~torch.utils.data.Sampler`
implementations and the default options of
:class:`~torch.utils.data.DataLoader`. Subclasses could also optionally
implement :meth:`__getitems__`, for speedup batched samples loading.
This method accepts list of indices of samples of batch and returns list
of samples.

.. note:: :class:`~torch.utils.data.DataLoader` by default constructs an
index sampler that yields integral indices. To make it work with a
map-style dataset with non-integral indices/keys, a custom sampler must
be provided.\*

------------------------------------------------------------------------

<a
href="https://github.com/Matheus-lla/pfc-semantic-segmentation/blob/main/pfc_packages/utils.py#L236"
target="_blank" style="float:right; font-size:smaller">source</a>

### pad_collate_fn

>  pad_collate_fn (batch, max_clusters=32)

*batch: lista de arrays (num_clusters_i, num_features) retorna:
padded_batch: (batch_size, max_clusters, num_features) mask:
(batch_size, max_clusters) -\> 1 para válidos, 0 para padding*

# Visualizer for Point Clouds

------------------------------------------------------------------------

<a
href="https://github.com/Matheus-lla/pfc-semantic-segmentation/blob/main/pfc_packages/utils.py#L257"
target="_blank" style="float:right; font-size:smaller">source</a>

### PointCloudVisualizer

>  PointCloudVisualizer (point_size:float=1.0, grid_size=50,
>                            grid_spacing=1.0, grid_line_width=10,
>                            cluster_viz=False)

\*Visualizer class for rendering point clouds using Open3D with
color-coded semantic labels.

Args: point_size (float): Default size of points in the Open3D viewer.\*

------------------------------------------------------------------------

<a
href="https://github.com/Matheus-lla/pfc-semantic-segmentation/blob/main/pfc_packages/utils.py#L620"
target="_blank" style="float:right; font-size:smaller">source</a>

### run_viz

>  run_viz (point_cloud, normal_d_tuple=None, **visualizer_params)

------------------------------------------------------------------------

<a
href="https://github.com/Matheus-lla/pfc-semantic-segmentation/blob/main/pfc_packages/utils.py#L643"
target="_blank" style="float:right; font-size:smaller">source</a>

### main_viz

>  main_viz (temp_dir)

# Save

------------------------------------------------------------------------

<a
href="https://github.com/Matheus-lla/pfc-semantic-segmentation/blob/main/pfc_packages/utils.py#L692"
target="_blank" style="float:right; font-size:smaller">source</a>

### save_clusters

>  save_clusters (point_cloud:numpy.ndarray, seq:str, frame_id:str,
>                     output_base_path:str)

\*Salva os rótulos preditos em formato .label seguindo a estrutura do
SemanticKITTI.

Args: point_cloud (np.ndarray): Array Nx6 com colunas \[x, y, z,
true_label, predicted_label, scanline_index\]. seq (str): Número da
sequência (ex: ‘00’, ‘01’, …). frame_id (str): ID do frame (ex:
‘000123’). output_base_path (str): Caminho base até
`data_odometry_cluster_pred/dataset/sequences`.\*

# Cluster processing

------------------------------------------------------------------------

<a
href="https://github.com/Matheus-lla/pfc-semantic-segmentation/blob/main/pfc_packages/utils.py#L718"
target="_blank" style="float:right; font-size:smaller">source</a>

### verificar_consistencia_labels

>  verificar_consistencia_labels (pontos)

\*Verifica inconsistências entre rótulos verdadeiros e clusters
atribuídos. Também calcula estatísticas (média e desvio padrão) dos
clusters inconsistentes.

Entrada: pontos (np.ndarray): Array N x 6 contendo \[x, y, z,
true_label, pred_label, scanline_id\].

Retorna: - inconsistentes_total (int): Número de clusters inconsistentes
encontrados. - combinacoes_contadas (Counter): Contagem de combinações
de labels inconsistentes. - estatisticas_erro (dict): Médias e desvios
padrão das métricas de erro, mais erro do cluster 9.\*

------------------------------------------------------------------------

<a
href="https://github.com/Matheus-lla/pfc-semantic-segmentation/blob/main/pfc_packages/utils.py#L910"
target="_blank" style="float:right; font-size:smaller">source</a>

### get_statistics

>  get_statistics (idx, point_cloud)

------------------------------------------------------------------------

<a
href="https://github.com/Matheus-lla/pfc-semantic-segmentation/blob/main/pfc_packages/utils.py#L947"
target="_blank" style="float:right; font-size:smaller">source</a>

### compute_cluster_features

>  compute_cluster_features (cluster_points, true_label, num_bins=5)

------------------------------------------------------------------------

<a
href="https://github.com/Matheus-lla/pfc-semantic-segmentation/blob/main/pfc_packages/utils.py#L999"
target="_blank" style="float:right; font-size:smaller">source</a>

### extract_features_from_clusters

>  extract_features_from_clusters (point_cloud, min_cluster_size=3,
>                                      num_bins=5)

\*Extrai features dos clusters do point_cloud. - Ignora clusters
inconsistentes (exceto cluster 9, se drop_incosistentes=True) - Ignora
clusters onde todos os true_labels são 0 (exceto cluster 9) - Só calcula
features para clusters com pelo menos min_cluster_size pontos

Args: point_cloud (np.ndarray): Nx6 array \[x, y, z, true_label,
pred_label, scanline_id\] drop_incosistentes (bool): Ignora clusters
inconsistentes (exceto cluster 9) min_cluster_size (int): Tamanho mínimo
do cluster para calcular features

Returns: np.ndarray: Array de features dos clusters\*

# Plots

------------------------------------------------------------------------

<a
href="https://github.com/Matheus-lla/pfc-semantic-segmentation/blob/main/pfc_packages/utils.py#L1086"
target="_blank" style="float:right; font-size:smaller">source</a>

### plot_1

>  plot_1 (resumo_por_frame, seq_value=None, smoothing_window=51)

*Plota em 4 subplots verticais com dados suavizados: 1. Número total de
pontos 2. Número total de clusters 3. Pontos por cluster médio 4.
Porcentagem de redução da dimensionalidade*

------------------------------------------------------------------------

<a
href="https://github.com/Matheus-lla/pfc-semantic-segmentation/blob/main/pfc_packages/utils.py#L1206"
target="_blank" style="float:right; font-size:smaller">source</a>

### plot_2

>  plot_2 (resumo_por_frame, seq_value=None)

------------------------------------------------------------------------

<a
href="https://github.com/Matheus-lla/pfc-semantic-segmentation/blob/main/pfc_packages/utils.py#L1241"
target="_blank" style="float:right; font-size:smaller">source</a>

### plot_3

>  plot_3 (resumo_por_frame, seq_value=None, smoothing_window=51)

------------------------------------------------------------------------

<a
href="https://github.com/Matheus-lla/pfc-semantic-segmentation/blob/main/pfc_packages/utils.py#L1348"
target="_blank" style="float:right; font-size:smaller">source</a>

### plot_4

>  plot_4 (resumo_por_frame, seq_value=None)

*Plota sete métricas de erro em subplots separados no mesmo figure.*

------------------------------------------------------------------------

<a
href="https://github.com/Matheus-lla/pfc-semantic-segmentation/blob/main/pfc_packages/utils.py#L1431"
target="_blank" style="float:right; font-size:smaller">source</a>

### plot_5

>  plot_5 (combinacoes_geral, seq_value=None, top_n=10)
